# 构建性能问题分析

## 主要问题

### 1. frontend目录未被忽略（最严重）
- `.dockerignore` 中没有 `frontend/`
- `COPY . .` 会复制整个 frontend 目录（HTML/CSS/JS文件）
- 增加构建上下文大小，拖慢 COPY 步骤

### 2. Go版本不匹配
- Dockerfile: `golang:1.25.5-alpine`
- go.mod: `go 1.23.1`
- 可能导致不必要的镜像下载和兼容性问题

### 3. 构建参数未优化
- `go build` 没有使用缓存优化
- 缺少 `CGO_ENABLED=0`（禁用CGO可加速）
- 没有使用构建缓存层

### 4. 依赖下载未缓存
- `go mod download` 每次都重新下载
- 没有使用 Go 模块代理缓存优化

### 5. 其他文件被复制
- test/ 目录虽被忽略，但可能还有其他不需要的文件
- link_cpu.prof 等构建产物可能被复制

## 优化建议

### 立即优化（高优先级）
1. 在 `.dockerignore` 中添加 `frontend/`
2. 修正 Go 版本为 1.23.1
3. 优化 Dockerfile 构建缓存层
4. 添加 `CGO_ENABLED=0` 构建参数

### 次要优化
5. 使用 Go 构建缓存
6. 优化 COPY 步骤顺序
7. 清理不必要的文件
